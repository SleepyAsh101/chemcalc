<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SCP Chemistry Calculator — Site-65</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  padding: 20px;
  background: #0c0c0c;
  color: #eaeaea;
  font-family: Arial, Helvetica, sans-serif;
}
h1, h2 {
  margin-top: 0;
}
.box {
  background: #141414;
  border: 1px solid #333;
  border-radius: 8px;
  padding: 15px;
  margin-bottom: 15px;
}
input, select, button {
  background: #1f1f1f;
  color: #eee;
  border: 1px solid #444;
  padding: 6px;
  border-radius: 4px;
}
button {
  cursor: pointer;
}
button:hover {
  background: #2a2a2a;
}
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
}
th, td {
  border-bottom: 1px solid #333;
  padding: 6px;
  text-align: left;
}
.small {
  font-size: 12px;
  color: #aaa;
}
.flex {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}
</style>
</head>

<body>

<h1>SCP Chemistry Calculator — Site-65</h1>

<!-- CHEMICAL DATABASE -->
<div class="box">
<h2>Chemical Prices ($ / Liter)</h2>
<table id="chemTable"></table>
<button onclick="addChemical()">Add Chemical</button>
</div>

<!-- RECIPE BUILDER -->
<div class="box">
<h2>Recipe Builder</h2>

<div class="flex">
<input id="rName" placeholder="Recipe Name">
<input id="rYield" type="number" step="0.01" placeholder="Yield %">
</div>

<div class="flex" style="margin-top:10px;">
<select id="chemA"></select>
<input id="amtA" type="number" placeholder="Liters">
<select id="chemB"></select>
<input id="amtB" type="number" placeholder="Liters">
</div>

<button style="margin-top:10px;" onclick="calculate()">Calculate</button>
<button style="margin-top:10px;" onclick="saveRecipe()">Save Recipe</button>

<div id="output" class="small" style="margin-top:10px;"></div>
</div>

<!-- SAVED RECIPES -->
<div class="box">
<h2>Saved Recipes</h2>
<select id="savedRecipes"></select>
<button onclick="loadRecipe()">Load</button>
<button onclick="deleteRecipe()">Delete</button>
</div>

<script>
/* =======================
   DATA
======================= */
let chemicals = JSON.parse(localStorage.getItem("chemDB")) || {
  "Decaying Matter": 3000,
  "Interdimensional Matter": 2000,
  "Anomalous Matter": 1000,
  "Unstable Quantum Matter": 3000,
  "Amnesium": 3000
};

let recipes = JSON.parse(localStorage.getItem("recipes")) || {};

/* =======================
   INIT
======================= */
function init() {
  renderChemTable();
  updateSelects();
  loadRecipeList();
}
init();

/* =======================
   CHEM TABLE
======================= */
function renderChemTable() {
  let t = "<tr><th>Name</th><th>$/L</th><th></th></tr>";
  for (let c in chemicals) {
    t += `<tr>
      <td>${c}</td>
      <td><input type="number" value="${chemicals[c]}" onchange="updatePrice('${c}',this.value)"></td>
      <td><button onclick="removeChemical('${c}')">X</button></td>
    </tr>`;
  }
  document.getElementById("chemTable").innerHTML = t;
}

function updatePrice(name, val) {
  chemicals[name] = parseFloat(val);
  saveChemDB();
}

function addChemical() {
  let name = prompt("Chemical name:");
  if (!name) return;
  chemicals[name] = 0;
  saveChemDB();
  init();
}

function removeChemical(name) {
  delete chemicals[name];
  saveChemDB();
  init();
}

function saveChemDB() {
  localStorage.setItem("chemDB", JSON.stringify(chemicals));
}

/* =======================
   SELECTS
======================= */
function updateSelects() {
  let opts = Object.keys(chemicals)
    .map(c => `<option>${c}</option>`).join("");
  chemA.innerHTML = opts;
  chemB.innerHTML = opts;
}

/* =======================
   CALCULATION
======================= */
function calculate() {
  let a = chemA.value;
  let b = chemB.value;
  let la = parseFloat(amtA.value);
  let lb = parseFloat(amtB.value);
  let y = parseFloat(rYield.value) / 100;

  if (!a || !b || !la || !lb || !y) return;

  let cost = la * chemicals[a] + lb * chemicals[b];
  let outputL = (la + lb) * y;
  let costPerL = cost / outputL;

  output.innerHTML =
    `Total Cost: $${cost.toFixed(2)}<br>
     Output: ${(outputL*1000).toFixed(1)} mL<br>
     Cost / L: $${costPerL.toFixed(2)}`;
}

/* =======================
   RECIPES
======================= */
function saveRecipe() {
  let name = rName.value;
  if (!name) return alert("Name required");

  recipes[name] = {
    a: chemA.value,
    b: chemB.value,
    la: amtA.value,
    lb: amtB.value,
    y: rYield.value
  };
  localStorage.setItem("recipes", JSON.stringify(recipes));
  loadRecipeList();
}

function loadRecipeList() {
  savedRecipes.innerHTML = Object.keys(recipes)
    .map(r => `<option>${r}</option>`).join("");
}

function loadRecipe() {
  let r = recipes[savedRecipes.value];
  if (!r) return;
  chemA.value = r.a;
  chemB.value = r.b;
  amtA.value = r.la;
  amtB.value = r.lb;
  rYield.value = r.y;
}

function deleteRecipe() {
  delete recipes[savedRecipes.value];
  localStorage.setItem("recipes", JSON.stringify(recipes));
  loadRecipeList();
}
</script>

</body>
</html>
